workflows:
  ios_release:
    name: iOS Release Build
    platform: ios
    flutter: stable
    xcode: latest
    ios:
      export_method: app-store  # Si tu veux une version App Store, sinon utilise 'ad-hoc' ou 'development'
    scripts:
      - name: Install dependencies
        script: |
          flutter pub get
      - name: Build iOS
        script: |
          flutter build ios --release --no-codesign  # Création du build en mode release sans signature
      - name: Generate IPA
        script: |
          xcodebuild -workspace ios/Runner.xcworkspace -scheme Runner archive -archivePath $PWD/build/ios/archive/Runner.xcarchive
          xcodebuild -exportArchive -archivePath $PWD/build/ios/archive/Runner.xcarchive -exportPath $PWD/build/ios/ipa -exportOptionsPlist ios/ExportOptions.plist
    artifacts:
      - build/ios/ipa/*.ipa  # C'est ici que le fichier .ipa sera généré
